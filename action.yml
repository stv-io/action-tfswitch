name: 'tfswitch'

description: 'Setup tfswitch to install a specific version of terraform'

inputs:
  version:
    description: 'The tfswitch version'
    required: false
    default: "0.13.1308"

runs:
  using: 'composite'
  steps:
    - name: Check Runner OS
      if: ${{ runner.os != 'Linux' }}
      shell: bash
      run: |
        echo "::error title=â›” error hint::This action is only supported on Linux Runners"
        exit 1
    - name: Install tfswitch
      shell: bash
      id: install
      run: |
        curl -sLo install.sh https://raw.githubusercontent.com/warrensbox/terraform-switcher/release/install.sh 
        mkdir -p $HOME/.bin
        bash -x ./install.sh ${{ inputs.version }} -b $HOME/.bin
        $HOME/.bin/tfswitch --version
        export PATH=$PATH:$HOME/.bin
        tfswitch --version
        echo $HOME/.bin >> $GITHUB_PATH
        unlink /usr/local/bin/terraform
